<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ å‡æ³•å¤§æŒ‘æˆ˜ï¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        }
        /* ä¸ºè¾“å…¥æ¡†èšç„¦æ—¶æ·»åŠ æ›´æ˜æ˜¾çš„è½®å»“ */
        input[type="number"]:focus {
            outline: 2px solid #60a5fa; /* Tailwind blue-400 */
            outline-offset: 2px;
        }
        /* è‡ªå®šä¹‰æŒ‰é’®è¿‡æ¸¡æ•ˆæœ */
        .btn-primary {
            @apply bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-all duration-200 ease-in-out transform hover:scale-105;
        }
        .btn-success {
            @apply bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-all duration-200 ease-in-out transform hover:scale-105;
        }
        .btn-warning {
            @apply bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-all duration-200 ease-in-out transform hover:scale-105;
        }
        /* ä¸ºåé¦ˆä¿¡æ¯æ·»åŠ åŠ¨ç”» */
        .feedback-animation {
            animation: fadeInScale 0.5s ease-out;
        }
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-200 via-indigo-200 to-purple-300 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl w-full max-w-lg text-center">
        <h1 class="text-3xl sm:text-4xl font-bold text-purple-600 mb-6">
            åŠ å‡æ³•å¤§æŒ‘æˆ˜ï¼ğŸš€
        </h1>

        <div id="game-area">
            <div class="mb-6 text-gray-700">
                <p class="text-lg">
                    å½“å‰å…³å¡: <span id="current-level" class="font-semibold text-xl text-indigo-600">1</span>
                    (<span id="level-description" class="font-semibold text-indigo-500">10ä»¥å†…åŠ å‡æ³•</span>)
                </p>
                <p class="text-md mt-1">
                    æœ¬å…³è¿›åº¦: <span id="correct-answers-count" class="font-semibold text-green-600">0</span> /
                    <span id="target-answers-count" class="font-semibold text-green-600">5</span>
                </p>
            </div>

            <div id="problem-section" class="my-8 p-6 bg-indigo-50 rounded-lg shadow">
                <span id="num1" class="text-5xl sm:text-6xl font-bold text-blue-600"></span>
                <span id="operator" class="text-5xl sm:text-6xl font-bold text-red-500 mx-2 sm:mx-4"></span>
                <span id="num2" class="text-5xl sm:text-6xl font-bold text-blue-600"></span>
                <span class="text-5xl sm:text-6xl font-bold text-gray-700 mx-2 sm:mx-4">=</span>
                <span class="text-5xl sm:text-6xl font-bold text-gray-700">?</span>
            </div>

            <div class="flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4">
                <input type="number" id="answer-input" inputmode="numeric" pattern="[0-9]*"
                       class="text-2xl p-3 border-2 border-gray-300 rounded-lg w-full sm:w-48 text-center shadow-sm focus:border-blue-500 focus:ring-blue-500 transition-colors"
                       placeholder="è¾“å…¥ç­”æ¡ˆ">
                <button id="submit-button" class="btn-primary w-full sm:w-auto">
                    æäº¤ç­”æ¡ˆ
                </button>
            </div>

            <div id="feedback" class="mt-6 text-xl font-semibold min-h-[30px]">
                </div>
        </div>

        <div id="level-complete" class="hidden mt-8">
            <h2 class="text-3xl font-bold text-green-500 mb-4">ğŸ‰ æ­å–œï¼ä½ å·²å®Œæˆæœ¬å…³ï¼ğŸ‰</h2>
            <button id="next-level-button" class="btn-success">
                æŒ‘æˆ˜ä¸‹ä¸€å…³
            </button>
        </div>

        <div id="game-complete" class="hidden mt-8">
            <h2 class="text-3xl font-bold text-yellow-500 mb-4">ğŸ† å¤ªæ£’äº†ï¼ä½ å·²å®Œæˆæ‰€æœ‰æŒ‘æˆ˜ï¼ğŸ†</h2>
            <button id="restart-button" class="btn-warning">
                é‡æ–°å¼€å§‹
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // HTML å…ƒç´ è·å–
            const num1El = document.getElementById('num1');
            const operatorEl = document.getElementById('operator');
            const num2El = document.getElementById('num2');
            const answerInput = document.getElementById('answer-input');
            const submitButton = document.getElementById('submit-button');
            const feedbackEl = document.getElementById('feedback');
            const currentLevelEl = document.getElementById('current-level');
            const levelDescriptionEl = document.getElementById('level-description');
            const correctAnswersCountEl = document.getElementById('correct-answers-count');
            const targetAnswersCountEl = document.getElementById('target-answers-count');

            const gameAreaEl = document.getElementById('game-area');
            const levelCompleteEl = document.getElementById('level-complete');
            const nextLevelButton = document.getElementById('next-level-button');
            const gameCompleteEl = document.getElementById('game-complete');
            const restartButton = document.getElementById('restart-button');

            // å…³å¡å®šä¹‰
            // maxNum: é¢˜ç›®ä¸­æ•°å­—çš„æœ€å¤§å€¼ (å¯¹äºåŠ æ³•ï¼Œå’Œå¯èƒ½è¶…è¿‡maxNumï¼›å¯¹äºå‡æ³•ï¼Œè¢«å‡æ•°å’Œå‡æ•°éƒ½åœ¨maxNumå†…)
            // target: éœ€è¦ç­”å¯¹å¤šå°‘é¢˜æ‰èƒ½è¿‡å…³
            const levels = [
                { maxNum: 10, description: "10ä»¥å†…åŠ å‡æ³•", target: 5 },
                { maxNum: 20, description: "20ä»¥å†…åŠ å‡æ³•", target: 7 },
                { maxNum: 50, description: "50ä»¥å†…åŠ å‡æ³•", target: 8 },
                { maxNum: 100, description: "100ä»¥å†…åŠ å‡æ³•", target: 10 }
            ];

            let currentLevelIndex = 0; // å½“å‰å…³å¡ç´¢å¼•
            let num1, num2, operator, correctAnswer;
            let correctAnswersInLevel = 0; // å½“å‰å…³å¡å·²ç­”å¯¹é¢˜ç›®æ•°é‡

            // ç”Ÿæˆé¢˜ç›®
            function generateProblem() {
                const level = levels[currentLevelIndex];
                const maxNumber = level.maxNum;

                // éšæœºé€‰æ‹© '+' æˆ– '-'
                operator = Math.random() < 0.5 ? '+' : '-';

                num1 = Math.floor(Math.random() * (maxNumber + 1)); // ç”Ÿæˆ 0 åˆ° maxNumber ä¹‹é—´çš„æ•°
                num2 = Math.floor(Math.random() * (maxNumber + 1)); // ç”Ÿæˆ 0 åˆ° maxNumber ä¹‹é—´çš„æ•°

                if (operator === '-') {
                    // ç¡®ä¿å‡æ³•ç»“æœéè´Ÿï¼Œå¦‚æœ num1 < num2ï¼Œåˆ™äº¤æ¢å®ƒä»¬
                    if (num1 < num2) {
                        [num1, num2] = [num2, num1];
                    }
                    // é¿å…åœ¨ä½çº§åˆ«å‡ºç°è¿‡å¤š 0-0 çš„æƒ…å†µ
                    if (maxNumber <= 10 && num1 === 0 && num2 === 0) {
                        num1 = Math.floor(Math.random() * maxNumber) + 1; // ç¡®ä¿ num1 è‡³å°‘ä¸º 1
                        num2 = Math.floor(Math.random() * num1);      // num2 å°äº num1
                    }
                } else { // åŠ æ³•
                    // å¯¹äºåŠ æ³•ï¼Œå¦‚æœé¢˜ç›®æ˜¯ "10ä»¥å†…åŠ æ³•"ï¼Œå¹¶ä¸”å¸Œæœ›å’Œä¹Ÿä¸è¶…è¿‡10ï¼Œå¯ä»¥åœ¨è¿™é‡Œè°ƒæ•´
                    // ä¾‹å¦‚: if (maxNumber === 10 && num1 + num2 > 10) { // é‡æ–°ç”Ÿæˆæˆ–è°ƒæ•´æ•°å­— }
                    // å½“å‰è®¾è®¡æ˜¯æ“ä½œæ•°åœ¨ maxNumber å†…ï¼Œå’Œå¯èƒ½è¶…è¿‡ maxNumber
                }

                // è®¡ç®—æ­£ç¡®ç­”æ¡ˆ
                if (operator === '+') {
                    correctAnswer = num1 + num2;
                } else {
                    correctAnswer = num1 - num2;
                }

                // æ›´æ–°ç•Œé¢æ˜¾ç¤º
                num1El.textContent = num1;
                operatorEl.textContent = operator;
                num2El.textContent = num2;

                updateUIState();
            }

            // æ›´æ–°ç•Œé¢çŠ¶æ€ï¼ˆå…³å¡ä¿¡æ¯ã€è¿›åº¦ç­‰ï¼‰
            function updateUIState() {
                const level = levels[currentLevelIndex];
                currentLevelEl.textContent = currentLevelIndex + 1;
                levelDescriptionEl.textContent = level.description;
                correctAnswersCountEl.textContent = correctAnswersInLevel;
                targetAnswersCountEl.textContent = level.target;
                feedbackEl.textContent = ''; // æ¸…ç©ºä¸Šä¸€é¢˜çš„åé¦ˆ
                feedbackEl.className = 'mt-6 text-xl font-semibold min-h-[30px]'; // é‡ç½®æ ·å¼
                answerInput.value = ''; // æ¸…ç©ºè¾“å…¥æ¡†
                answerInput.focus(); // è‡ªåŠ¨èšç„¦è¾“å…¥æ¡†
            }

            // æ£€æŸ¥ç­”æ¡ˆ
            function checkAnswer() {
                const userAnswerText = answerInput.value.trim();
                if (userAnswerText === '') {
                    feedbackEl.textContent = "è¯·è¾“å…¥ç­”æ¡ˆå“¦ï¼âœï¸";
                    feedbackEl.className = 'mt-6 text-xl font-semibold min-h-[30px] text-yellow-600 feedback-animation';
                    return;
                }

                const userAnswer = parseInt(userAnswerText);

                if (isNaN(userAnswer)) {
                    feedbackEl.textContent = "è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—ï¼ğŸ”¢";
                    feedbackEl.className = 'mt-6 text-xl font-semibold min-h-[30px] text-red-500 feedback-animation';
                    return;
                }

                if (userAnswer === correctAnswer) {
                    feedbackEl.textContent = "ç­”å¯¹å•¦ï¼ä½ çœŸæ£’ï¼ğŸ¥³";
                    feedbackEl.className = 'mt-6 text-xl font-semibold min-h-[30px] text-green-500 feedback-animation';
                    correctAnswersInLevel++;

                    if (correctAnswersInLevel >= levels[currentLevelIndex].target) {
                        // å…³å¡å®Œæˆ
                        setTimeout(showLevelCompleteScreen, 1000); // ç¨ä½œåœç•™åæ˜¾ç¤ºè¿‡å…³ç•Œé¢
                    } else {
                        // ç»§ç»­æœ¬å…³ä¸‹ä¸€é¢˜
                        setTimeout(generateProblem, 1200);
                    }
                } else {
                    feedbackEl.textContent = `ä¸å¯¹å“¦ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ ${correctAnswer}ã€‚åŠ æ²¹ï¼ğŸ’ª`;
                    feedbackEl.className = 'mt-6 text-xl font-semibold min-h-[30px] text-red-500 feedback-animation';
                    // ç­”é”™å¯ä»¥è€ƒè™‘æ˜¯å¦é‡ç½®è¿ç»­ç­”å¯¹æ¬¡æ•°ï¼Œæˆ–é‡‡å–å…¶ä»–ç­–ç•¥
                    // correctAnswersInLevel = 0; // å¦‚æœå¸Œæœ›ç­”é”™åæœ¬å…³é‡æ–°è®¡æ•°ï¼Œå¯ä»¥å–æ¶ˆè¿™è¡Œæ³¨é‡Š

                    // ç­”é”™åä¹Ÿå‡ºä¸‹ä¸€é¢˜
                    setTimeout(generateProblem, 2500); // é”™è¯¯æç¤ºåœç•™æ—¶é—´é•¿ä¸€äº›
                }
                // å®æ—¶æ›´æ–°è¿›åº¦
                correctAnswersCountEl.textContent = correctAnswersInLevel;
            }

            // æ˜¾ç¤ºå…³å¡å®Œæˆç•Œé¢
            function showLevelCompleteScreen() {
                gameAreaEl.classList.add('hidden'); // éšè—æ¸¸æˆåŒºåŸŸ
                if (currentLevelIndex >= levels.length - 1) {
                    // æ‰€æœ‰å…³å¡å®Œæˆ
                    gameCompleteEl.classList.remove('hidden');
                } else {
                    // è¿›å…¥ä¸‹ä¸€å…³
                    levelCompleteEl.classList.remove('hidden');
                }
            }

            // è¿›å…¥ä¸‹ä¸€å…³
            function goToNextLevel() {
                currentLevelIndex++;
                correctAnswersInLevel = 0; // é‡ç½®æœ¬å…³ç­”å¯¹é¢˜æ•°
                levelCompleteEl.classList.add('hidden'); // éšè—è¿‡å…³æç¤º
                gameAreaEl.classList.remove('hidden'); // æ˜¾ç¤ºæ¸¸æˆåŒºåŸŸ
                if (currentLevelIndex < levels.length) {
                    generateProblem(); // ç”Ÿæˆæ–°å…³å¡çš„é¢˜ç›®
                } else {
                    // è¿™ä¸ªæƒ…å†µç†è®ºä¸Šç”± showLevelCompleteScreen ä¸­çš„ gameCompleteEl å¤„ç†
                    console.error("è¯•å›¾è¿›å…¥ä¸€ä¸ªä¸å­˜åœ¨çš„å…³å¡");
                }
            }

            // é‡æ–°å¼€å§‹æ¸¸æˆ
            function restartGame() {
                currentLevelIndex = 0;
                correctAnswersInLevel = 0;
                gameCompleteEl.classList.add('hidden'); // éšè—é€šå…³æç¤º
                levelCompleteEl.classList.add('hidden'); // ä»¥é˜²ä¸‡ä¸€ä¹Ÿéšè—è¿™ä¸ª
                gameAreaEl.classList.remove('hidden'); // æ˜¾ç¤ºæ¸¸æˆåŒºåŸŸ
                generateProblem(); // å¼€å§‹ç¬¬ä¸€å…³
            }

            // äº‹ä»¶ç›‘å¬
            submitButton.addEventListener('click', checkAnswer);
            answerInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    checkAnswer();
                }
            });
            nextLevelButton.addEventListener('click', goToNextLevel);
            restartButton.addEventListener('click', restartGame);

            // åˆå§‹åŒ–æ¸¸æˆ
            generateProblem();
        });
    </script>
</body>
</html>
